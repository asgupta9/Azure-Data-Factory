{
	"name": "dataflow1",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "dataMall",
						"type": "DatasetReference"
					},
					"name": "source1"
				},
				{
					"dataset": {
						"referenceName": "LaborCategoriesByPartnerMapping",
						"type": "DatasetReference"
					},
					"name": "source2"
				}
			],
			"sinks": [],
			"transformations": [
				{
					"name": "JOIN"
				}
			],
			"script": "source(output(\n\t\tID as long,\n\t\tNAME as string,\n\t\tDescription as string,\n\t\tUtilizationEligibleIndicator as string,\n\t\tCustomerFacingIndicator as string,\n\t\tBillableIndicator as string,\n\t\tCategoryGroup as string,\n\t\tEffectiveStartDate as timestamp,\n\t\tEffectiveEndDate as timestamp\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tquery: 'SELECT a.AttributeValueDDObjectID as ID,\\nltrim(rtrim(a.AttributeValueName)) as [NAME] ,\\nltrim(rtrim(c.DataDictionaryObjectShortDesc)) as [Description] ,\\nltrim(rtrim(g.AttributeValueName)) as [UtilizationEligibleIndicator] ,\\nltrim(rtrim(e.AttributeValueName)) as [CustomerFacingIndicator] ,\\nltrim(rtrim(d.AttributeValueName)) as [BillableIndicator] ,\\nltrim(rtrim(f.AttributeValueName)) as [CategoryGroup] ,\\na.BusinessEffectiveStartDate [EffectiveStartDate],\\na.BusinessEffectiveEndDate [EffectiveEndDate]\\nFROM    dbo.TAXY01AttributeValue a \\nJOIN dbo.TAXY01Attribute b ON b.AttributeDataDictionaryObjID = a.OwningAttributeDDObjectID\\nJOIN dbo.TAXY01DataDictionaryObject c ON c.DataDictionaryObjectID = a.AttributeValueDDObjectID \\nLEFT JOIN ( SELECT  a.AttributeValueName , c.ChildAttributeValueDDObjID \\nFROM  dbo.TAXY01AttributeValue a \\n\\nJOIN dbo.TAXY01Attribute b ON b.AttributeDataDictionaryObjID = a.OwningAttributeDDObjectID \\nJOIN dbo.TAXY01AttributeValueRltn c ON c.ParentAttributeValueDDObjID = a.AttributeValueDDObjectID\\n\\nWHERE   b.AttributeName = \\'Labor Category Billable Indicator\\') d ON d.ChildAttributeValueDDObjID = a.AttributeValueDDObjectID \\n\\nLEFT JOIN ( SELECT  a.AttributeValueName ,c.ChildAttributeValueDDObjID FROM    dbo.TAXY01AttributeValue a \\nJOIN dbo.TAXY01Attribute b ON b.AttributeDataDictionaryObjID = a.OwningAttributeDDObjectID \\nJOIN dbo.TAXY01AttributeValueRltn c ON c.ParentAttributeValueDDObjID = a.AttributeValueDDObjectID \\nWHERE   b.AttributeName = \\'Labor Category Task Related Indicator\\') e ON e.ChildAttributeValueDDObjID = a.AttributeValueDDObjectID\\nLEFT JOIN ( SELECT  a.AttributeValueName ,\\nc.ChildAttributeValueDDObjID FROM    dbo.TAXY01AttributeValue a \\n\\nJOIN dbo.TAXY01Attribute b ON b.AttributeDataDictionaryObjID = a.OwningAttributeDDObjectID\\n\\nJOIN dbo.TAXY01AttributeValueRltn c ON c.ParentAttributeValueDDObjID = a.AttributeValueDDObjectID \\nWHERE   b.AttributeName = \\'Labor Category Group Name\\') f ON f.ChildAttributeValueDDObjID = a.AttributeValueDDObjectID \\nLEFT JOIN ( SELECT  a.AttributeValueName ,c.ChildAttributeValueDDObjID FROM    dbo.TAXY01AttributeValue a \\nJOIN dbo.TAXY01Attribute b ON b.AttributeDataDictionaryObjID = a.OwningAttributeDDObjectID\\nJOIN dbo.TAXY01AttributeValueRltn c ON c.ParentAttributeValueDDObjID = a.AttributeValueDDObjectID WHERE   b.AttributeName = \\'Labor Category Utilization Eligible Indicator\\') g ON g.ChildAttributeValueDDObjID = a.AttributeValueDDObjectID \\nWHERE   AttributeName = \\'Labor Category Name\\'',\n\tformat: 'query') ~> source1\nsource(output(\n\t\tISACTIVE as boolean,\n\t\tLABORCATEGORYID as integer,\n\t\tPARTNER as string,\n\t\tPARTNERLABORCATEGORYID as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false) ~> source2\nsource1, source2 join(ERROR_FUNCTION('') == ERROR_FUNCTION(''),\n\tjoinType:'inner',\n\tbroadcast: 'none')~> JOIN"
		}
	}
}